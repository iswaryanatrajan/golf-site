<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>Golf</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;700&family=Noto+Sans+JP&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+1p" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="stylesheet" type="text/css" href="../css/menu.css">
    <link rel="stylesheet" type="text/css" href="../css/responsive.css">
  <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="../js/chat.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/chat.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.5/index.global.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.5/locales/ja.global.js'></script>
    <!-- Popperjs -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- Tempus Dominus JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.39.0/js/tempusdominus-bootstrap-4.min.js" crossorigin="anonymous"></script>

<!-- Tempus Dominus Styles -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.39.0/css/tempusdominus-bootstrap-4.min.css" crossorigin="anonymous">
    <script>


let s = (new Date()).getTime().toString(16) + Math.random().toString(16).substring(2) + "0".repeat(16);
            let uuid = s.substr(0,8) + '-' + s.substr(8,4) + '-4000-8' + s.substr(12,3) + '-' + s.substr(15,12);

var events = [
          {
            start: '2023-04-06T13:00:00',
            end: '2023-04-06T14:00:00',
            title:'Trial',
            description:'Some description about event',
            id:uuid
          },
          {
            start: '2023-04-06T16:00:00',
            end: '2023-04-06T18:00:00',
            title:'Trial',
            description:'Some description about event',
            id:uuid
          },
          {
            start: '2023-04-07T13:00:00',
            end: '2023-04-07T14:00:00',
            title:'Course 1',
            description:'Some description about event',
            id:uuid
          },
          {
            start: '2023-04-07T16:00:00',
            end: '2023-04-07T18:00:00',
            title:'Course 1',
            description:'Some description about event',
            id:uuid
          },
          {
            start: '2023-04-08T08:00:00',
            end: '2023-04-08T20:00:00',
            title:'Course 2',
            description:'Some description about event',
            id:uuid
          }
        ];
   
        var calendar; 

        document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('mycalendar');
        calendar = new FullCalendar.Calendar(calendarEl, {
          headerToolbar: {
    left: 'prev,next',
    center: 'title',
    right: 'timeGridWeek,listWeek' // user can switch between the two
  },
        locale: 'ja',
        initialView: 'timeGridWeek',
        slotDuration: '01:00',
        editable: true,
        selectable:true,
        height: "auto",
        slotMinTime: '08:00', // 8am
        slotMaxTime: '20:00', // 8pm

        events: function(info, successCallback, failureCallback) {
            successCallback(events);
  },
  select: function(selectionInfo) {
    $('#createEventModal').modal('show');
    $('#createEvent').on('click',function(){
      var title= $('#event-title').val();
      console.log(title)
      var desc= $('#event-desc').val();
      calendar.addEvent({
        start: selectionInfo.start,
        end: selectionInfo.end ,//need these and not endTime/startTime, otherwise they won't re-render
        id:uuid,
        title:title,
        description:desc
      });
      $('#createEvent').unbind('click');
      $('#event-title').val("");
      $('#event-desc').val("");
      $('#createEventModal').modal('hide');
           });
   
      calendar.unselect();
    },
   
		/*	eventClick: function(info ){
		
			  // $('#mycalendar').fullCalendar('removeEvents',event._id);
         if (confirm(`Are you sure you want to delete the slot `+info.event.title + `?`)) {
      info.event.remove();
    }
			},*/
      eventClick: function(info) {
        /*  var title = prompt('Event Title:', info.event.title, { buttons: { Ok: true, Cancel: false} });
          var description = prompt('Event Description:', info.event.description, { buttons: { Ok: true, Cancel: false} });
console.log(title);
          if (title){
            info.event.title = title;
            info.event.setProp('title', title);
              //calendar.updateEvent();*/
             // openpopup();
             console.log(info.event);
              $('#title').val(info.event.title);
             $('#modalWhen').text(info.event.start.toLocaleDateString() + " " + info.event.start.toLocaleTimeString() + " - " + info.event.end.toLocaleTimeString());
             $('#modalDesc').val(info.event.extendedProps.description);
             $('#modalId').text(info.event.id);
             $('#calendarModal').modal('show');
             $('#editEvent').click(function () {
              var title= $('#title').val();
              var desc= $('#modalDesc').val();
              info.event.setProp('title', title);
              info.event.setExtendedProp('description', desc);
            $('#calendarModal').modal('hide');
        });
             $('#deleteEvent').click(function () {
            var id = $('#ModalId').val();
            console.log("thy");
            if (confirm("Are you sure you want to delete this event?")){
              info.event.remove(id);
            }
           // $("#calendar").fullCalendar('addEventSource', events);
            $('#calendarModal').modal('hide');
        });
        
},
/*eventContent: function (args)
  {
    //const text = args.event._def.title + '<button onclick="info.event.remove();" style="float: right"> Delete </button>';
    let italicEl = document.createElement('div')


  italicEl.innerHTML = args.event._def.title + args.event.start +'<button style="float: right"> Delete </button>';


let arrayOfDomNodes = [ italicEl ]
return { domNodes: arrayOfDomNodes }

},*/

      eventDidMount: function(info) {
                var pill = document.createElement("span");
                var fcevent = info.el.querySelector('.fc-event-title'); // for gridView
                
        //console.log(info.event.extendedProps.description);
                    let description = document.createElement('div');
                    description.innerHTML=info.event.extendedProps.description;
                   // document.querySelector('.fc-event-title-container').append(description);
                    if (fcevent ) { 
                       //fcevent.textContent += " ";
                       fcevent.append(description);
                    }
                    
                },
/*  eventReceive: function( info ) {

//get the bits of data we want to send into a simple object
var eventData = {
  title: info.event.title,
  start: info.event.start,
  end: info.event.end,
  id: info.event.id,
};
//send the data via an AJAX POST request, and log any response which comes from the server
fetch('add_event.php', {
  method: 'POST',
  headers: {'Accept': 'application/json'},
  body: encodeFormData(eventData)
})
.then(response => console.log(response))
.catch(error => console.log(error));
}*/
        });
        calendar.render();
      });
  
      $('#deleteEvent').click(function () {
            var id = $('#ModalId').val();
            console.log("thy");
            calendar.event.remove(id);
           // $('#calendar').fullCalendar('removeEvents', id);
           // $("#calendar").fullCalendar('addEventSource', events);
            $('#calendarModal').modal('hide');
        });
       
    </script>

     <style>
.eventdetails span{
color:#426ecc
}
.imagePreview {
    width: 100%;
    height: 180px;
    background-position: center center;
  background:url(http://cliquecities.com/assets/no-image-e3699ae23f866f6cbdf8ba2443ee5c4e.jpg);
  background-color:#fff;
    background-size: cover;
  background-repeat:no-repeat;
    display: inline-block;
    border-radius:10px
}

    </style>
  </head>
  <body>
    <div id="wrapper" class="forced ">
      <div class="topbar">
  
        <!-- LOGO -->
        <div class="topbar-left">
               <a href="index.html" class="logo"><span>Golf</span></a>
        </div>
  
        <!-- Button mobile view to collapse sidebar menu -->
        <div class="navbar navbar-default" role="navigation">
               <div class="container">
  
                      <!-- Navbar-left -->
                      <nav class="navbar top-navbar">
                        <a class="btn border-0 waves-effect button-menu-mobile open-left" id="menu-btn"><i class="fa fa-bars"></i></a>
                      </nav>
  
                          <!-- Right(Notification) -->
                          <ul class="nav navbar-nav navbar-right flex-row align-items-center">
                            <li class="ps-2">
                              <a href="#" class="dropdown-toggle waves-effect user-chat  menu-right text-decoration-none"  id="chatbtn" role="button" data-bs-toggle="dropdown" id="chat" aria-expanded="true">
                                <i class="fa-brands fa-rocketchat"></i>
                              </a>
                              <div class="dropdown-menu dropdown-menu-right arrow-dropdown-menu arrow-menu-right chat-list shadow">
                                <div class="chat-sidebar">
                                  <div class="box-header with-border">   
                                    <h3 class="box-title">Contacts</h3> 
                                  
                                    </div>
                                    <div id="chat-names" class="chat-names">
                                  <div class="sidebar-name">
                                      <!-- Pass username and display name to register popup -->
                                      <a href="javascript:register_popup('Contact 1', 'Contact 1');">
                                          <img width="30" height="30" src="https://bootdey.com/img/Content/user_1.jpg" />
                                          <span>Contact 1</span>
                                      </a>
                                  </div>
                                  <div class="sidebar-name">
                                      <a href="javascript:register_popup('qnimate', 'QNimate');">
                                          <img width="30" height="30" src="https://bootdey.com/img/Content/user_1.jpg" />
                                          <span>QNimate</span>
                                      </a>
                                  </div>
                                  <div class="sidebar-name">
                                      <a href="javascript:register_popup('qscutter', 'QScutter');">
                                          <img width="30" height="30" src="https://bootdey.com/img/Content/user_1.jpg"  />
                                          <span>QScutter</span>
                                      </a>
                                  </div>
                                  <div class="sidebar-name">
                                      <a href="javascript:register_popup('qidea', 'QIdea');">
                                          <img width="30" height="30" src="https://bootdey.com/img/Content/user_1.jpg"  />
                                          <span>QIdea</span>
                                      </a>
                                  </div>
                                  <div class="sidebar-name">
                                      <a href="javascript:register_popup('qazy', 'QAzy');">
                                          <img width="30" height="30" src="https://bootdey.com/img/Content/user_1.jpg"  />
                                          <span>QAzy</span>
                                      </a>
                                  </div>
                                  <div class="sidebar-name">
                                      <a href="javascript:register_popup('qblock', 'QBlock');">
                                          <img width="30" height="30" src="https://bootdey.com/img/Content/user_1.jpg" />
                                          <span>QBlock</span>
                                      </a>
                                  </div>
                                </div>
                              </div>
                              </div>
                              </li>
                              <li class="ps-2">
                                <a href="#" class="waves-effect user-notification  menu-right text-decoration-none"  id="notificationbtn" role="button" data-bs-toggle="dropdown" aria-expanded="true">
                                  <i class="fa fa-bell"></i><!-- <span class="badge bg-danger rounded-circle">4</span>-->
                                </a>
                                <div class="dropdown-menu dropdown-menu-right arrow-dropdown-menu arrow-menu-right notification-list shadow">
                                  <div class="notification-box">
                                    <ul class="notification-drop ps-0">
                                          <li>First Notification item from user goes here</li>
                                          <li>Second Notification Item</li>
                                          <li>Third  Notification Item</li>
                                    </ul>
                                </div>
                                </div>
                                </li>
                                 <li class="dropdown user-box ps-3">
                                        <a href="#" class="dropdown-toggle waves-effect user-link text-decoration-none" role="button" data-bs-toggle="dropdown" id="profile" aria-expanded="true">
                                          <img alt="..." src="https://images.unsplash.com/photo-1610271340738-726e199f0258?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=facearea&amp;facepad=3&amp;w=256&amp;h=256&amp;q=80" class="avatar avatar-sm rounded-circle me-2">
                                        </a>
      
                                        <ul class="dropdown-menu dropdown-menu-right user-list notify-list">
      
                                               <li><a href="../index.html"><i class="ti-power-off m-r-5"></i> Logout</a></li>
                                        </ul>
                                 </li>
      
                          </ul> <!-- end navbar-right -->
  
               </div><!-- end container -->
        </div><!-- end navbar -->
  </div>
  
     
        <div class="left side-menu">
          <div id="sidebar-menu">
            <ul>
                   <li class="menu-title"> NAVIGATION </li>

                   <li class="has_sub"><a href="index.html" class="waves-effect"><i class="fa fa-home"></i><span>Home</span> </a> </li>
                   <li class="has_sub"><a href="posts.html" class="waves-effect"><i class="fa fa-feed"></i><span>ポスト</span> </a> </li>
                   <li class="has_sub"><a href="events.html" class="waves-effect"><i class="fa fa-calendar-days"></i><span>イベント</span> </a> 
                    <ul class="ps-1">
                      <li class=""><a class="waves-effect " href="createdevents.html">Created Events</a> </li>
                      <li class=""><a class="waves-effect " href="participatedevents.html">Joined Events<span class="badge bg-success ms-1 rounded-circle">5</span></a></li>
                    </ul></li>
                   <li class="has_sub"><a href="findteacher.html" class="waves-effect"><i class="fa fa-user"></i><span>先生を探す</span> </a> </li>
                   <li class="has_sub"><a href="schedule.html" class="waves-effect"><i class="fa fa-clock"></i><span>時刻表</span> </a> </li>
                   <hr>
                   <li class="has_sub">
                    <a href="../index.html" class="waves-effect"><i class="fa fa-power"></i><span>Logout</span> </a>
             </li>
                
      
            </ul>
      </div>
  
  
        </div>
        <div class="col content-page px-0 bg-grey"> 
  <div class="content">
          <div class="container pt-5">
          <div class="m-5">
          
                
               <div id="mycalendar"></div>
            
          </div>
    </div>

  </div>
  </div>
  <div id="calendarModal" class="modal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Event Details</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              
            </div>
            <div id="modalBody" class="modal-body">
             
              <form>
                <div class="mb-3">
                  <label for="title" class="form-label">Event Date:</label>
                  <div id="modalWhen" style="margin-top:5px;"></div>
                </div>
              <div class="mb-3">
                <label for="title" class="form-label">Event Title</label>
                <input type="text" class="form-control" id="title" >
              </div>
              <div class="mb-3">
                <label for="desc" class="form-label">Event Description</label>
                <textarea class="form-control" id="modalDesc"></textarea>
              </div>
            <h4 id="title" class="modal-title"></h4>
            
            <input id="modalId" type="hidden"/>
            <div id="modalDesc" style="margin-top:5px;"></div>
            
            </form>

            </div>

            <div class="modal-footer">
              
                <button class="btn" data-bs-dismiss="modal" aria-hidden="true">Cancel</button>
                <button type="submit" class="btn btn-danger" id="deleteEvent">Delete Event</button>
                <button type="submit" class="btn btn-primary" id="editEvent">Save Changes</button>
            </div>
        </div>
    </div>
    </div>
    <div id="createEventModal" class="modal">
      <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create Event</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                
              </div>
              <div id="modalBody" class="modal-body">
                <form>
                  <div class="mb-3">
                    <label for="teacher-name" class="form-label">Event Title</label>
                    <input type="text" class="form-control" id="event-title" placeholder="Enter Title">
                  </div>
                  <div class="mb-3">
                    <label for="teacher-name" class="form-label">Event Description</label>
                    <textarea class="form-control" id="event-desc"></textarea>
                  </div>
                </form>
              </div>
  
              <div class="modal-footer">
                
                  <button class="btn" data-bs-dismiss="modal" aria-hidden="true">Cancel</button>
                  <button type="submit" class="btn btn-danger" id="createEvent">Create</button>
              </div>
          </div>
      </div>
      </div>
  </div>

    </body>
    </html>